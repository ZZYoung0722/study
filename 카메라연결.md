# 카메라 연결

### rtsp (real time streaming protocol)

- 스트리밍 미디어 서버를 컨트롤 하기위한 통신 시스템등을 위해 고안된 네트워크 프로토콜
- 스트리밍 시스템에서, 미디어 서버를 원격으로 제어할때 사용 (client -> server)
- play pauer 와 같은 명령어들을 미디어 서버로 보내며, 시간정보를 바탕으로 서버에 접근
- 실제로 미디어 스트리밍 데이터를 전송하지 않는다.
- 기본 포트는 554

### Node.js

node.js
- javascript 작성된 프로그램을 운영체제상에서 일반 어플리케이션 프로그램 처럼 실행시켜주는 런타임

노드를 통해 다양한 자바스크립트 애플리케이션을 실행할 수 있다.

서버를 실행하는 데 제일 많이 사용

확장성이 있는 네트워크 어플리케이션 개발에 사용되는 소프트웨어 플랫폼 특히 서버사이트에서 많이 사용

내장 HTTP 서버 라이브러리를 포함하고 있어 웹 서버에서 아파치 등의 별도 소프트웨어 없이 동작하는 것이 가능

터미널프로그램에서 node.js를 입력하여 브라우저 없이 바로 실행

★ node.js 이용하여 서버를 만들 수 있다. ★ 

cpu 부하가 큰 작업에 적합하지 않다.

장점

1. 멀티 스레드(프로그램 환경에 따라 둘 이상의 스레드(흐름)를 동시에 실행 가능) 방식에 비해 적은 컴퓨터 자원 사용
2. I/O 작업이 많은 서버로 적합
3. 웹 서버가 내장되어 있어 별도의 웹서버를 설치할 필요가 없다.
4. 자바스크립트 사용하기 때문에 json 형식과 쉽게 호환


### 웹브라우저에 RTSP 영상을 재생

FFmpeg 
- 디지털 음성 스트림과 영상 스트림에 대해서 다양한 종류의 형태로 기록하고 변환하는 컴퓨터 프로그램
- 오디오 또는 비디오 형식을 변환하는 도구
- 사용 이유 : 웹페이지는 정적인 이미지파일만 사용가능하기 때문에 FFmpeg 통해서 MJPG 파일을 동적인 이미지로 변환하여 전송
		  
소켓통신 사용 이유
- FFmpeg 통해서 RTSP를 사진으로 변환 하였지만 웹페이지의 요청은 비동기적으로 실행되기 때문에 양방향 통신을 위해 웹 소켓 기술 사용

소켓통신 
- 서버와 클라이언트 양방향 연결이 이루어지는 통신
- 클라이언트도 서버로 요청을 보낼 수 있고 서버도 클라이언트로 요청을 보낼 수 있는 통신, 자주 데이터를 주고 받는 환경에서 유리
			 
### jsmpeg
- javascript 로 작성된 비디오 플레이어
- ajax 통해 정적 비디오 로드 가능
- 웹소켓 통해 짧은 대기시간 스트리밍 허용
- **canvas** : 비디오 렌더링에 사용할 HTML Canvas 요소. 아무 것도 주어지지 않으면 렌더러는 자체 Canvas 요소를 만듭니다.
- 클라이언트 쪽에 jsmpeg 없으면 오류
- 사용하기 위해 모든 rtsp 스트림 및 출력을 websocket으로 스트리밍
- html5 스트리밍 비디오 (ffmpeg 필요)
- **웹에서 jsmpeg 이용해서 해당 영상 출력**



